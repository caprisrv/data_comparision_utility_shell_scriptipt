SET hive.cli.print.header=true;select
concat_ws(',',collect_set(cast(report_date as string))) as report_date,
concat_ws(',',collect_set(cast(offer_identifier as string))) as offer_identifier,
concat_ws(',',collect_set(cast(app_identifier as string))) as app_identifier,
concat_ws(',',collect_set(cast(consumer_identifier as string))) as consumer_identifier,
concat_ws(',',collect_set(cast(offer_type_code as string))) as offer_type_code,
concat_ws(',',collect_set(cast(offer_type_description as string))) as offer_type_description,
concat_ws(',',collect_set(cast(promo_identifier as string))) as promo_identifier,
concat_ws(',',collect_set(cast(product_identifier as string))) as product_identifier,
concat_ws(',',collect_set(cast(sub_product_identifier as string))) as sub_product_identifier,
concat_ws(',',collect_set(cast(accepted_offer_flag as string))) as accepted_offer_flag,
concat_ws(',',collect_set(cast(offer_good_until_date as string))) as offer_good_until_date,
concat_ws(',',collect_set(cast(rescindable_days as string))) as rescindable_days,
concat_ws(',',collect_set(cast(rescinded_date as string))) as rescinded_date,
concat_ws(',',collect_set(cast(amount as string))) as amount,
concat_ws(',',collect_set(cast(rate as string))) as rate,
concat_ws(',',collect_set(cast(origination_fee_amount as string))) as origination_fee_amount,
concat_ws(',',collect_set(cast(origination_fee_rate as string))) as origination_fee_rate,
concat_ws(',',collect_set(cast(account_number as string))) as account_number,
concat_ws(',',collect_set(cast(account_num_assigned_date_time as string))) as account_num_assigned_date_time,
concat_ws(',',collect_set(cast(annual_fee_amount as string))) as annual_fee_amount,
concat_ws(',',collect_set(cast(annual_fee_waived_mm as string))) as annual_fee_waived_mm,
concat_ws(',',collect_set(cast(late_fee_percent as string))) as late_fee_percent,
concat_ws(',',collect_set(cast(late_fee_minimum_amount as string))) as late_fee_minimum_amount,
concat_ws(',',collect_set(cast(offer_date_time as string))) as offer_date_time,
concat_ws(',',collect_set(cast(period_id as string))) as period_id,
concat_ws(',',collect_set(cast(first_payment_due_date as string))) as first_payment_due_date,
concat_ws(',',collect_set(cast(contract_date as string))) as contract_date,
concat_ws(',',collect_set(cast(account_expiration_date as string))) as account_expiration_date
FROM productreporting_qa.qa_std_retro_offer_data ;
